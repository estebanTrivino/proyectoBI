from datetime import datetime

#Lambda 2 - Transform function

#¿Cuales de los libros más populares en un mes x de un año x han sido premiados en ese año?

listadoTop = [{"book_id":"56597885","name":"Beautiful World, Where Are You","winning_category":"Fiction","cover":"https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1618329605l/56597885.jpg","url":"https://www.goodreads.com/choiceawards/best-fiction-books-2021"},{"book_id":"58744977","name":"The Last Thing He Told Me","winning_category":"Mystery & Thriller","cover":"https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1628623381l/58744977._SY475_.jpg","url":"https://www.goodreads.com/choiceawards/best-mystery-thriller-books-2021"},{"book_id":58745185,"name":"Malibu Rising","winning_category":"Historical Fiction","cover":"https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1628625865l/58745185._SY475_.jpg","url":"https://www.goodreads.com/choiceawards/best-historical-fiction-books-2021"},{"book_id":53138095,"name":"A ​Court of Silver Flames","winning_category":"Fantasy","cover":"https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1602570691l/53138095.jpg","url":"https://www.goodreads.com/choiceawards/best-fantasy-books-2021"},{"book_id":54985743,"name":"People We Meet on Vacation","winning_category":"Romance","cover":"https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1618913179l/54985743.jpg","url":"https://www.goodreads.com/choiceawards/best-romance-books-2021"},{"book_id":54493401,"name":"Project Hail Mary","winning_category":"Science Fiction","cover":"https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1597695864l/54493401.jpg","url":"https://www.goodreads.com/choiceawards/best-science-fiction-books-2021"},{"book_id":55829194,"name":"The Final Girl Support Group","winning_category":"Horror","cover":"https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1614275199l/55829194.jpg","url":"https://www.goodreads.com/choiceawards/best-horror-books-2021"},{"book_id":54305363,"name":"Broken","winning_category":"Humor","cover":"https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1597856341l/54305363.jpg","url":"https://www.goodreads.com/choiceawards/best-humor-books-2021"},{"book_id":55145261,"name":"The Anthropocene Reviewed","winning_category":"Nonfiction","cover":"https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1616514130l/55145261.jpg","url":"https://www.goodreads.com/choiceawards/best-nonfiction-books-2021"},{"book_id":54814676,"name":"Crying in H Mart","winning_category":"Memoir & Autobiography","cover":"https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1601937850l/54814676.jpg","url":"https://www.goodreads.com/choiceawards/best-memoir-autobiography-books-2021"},{"book_id":43868109,"name":"Empire of Pain: The Secret History of the Sackler Dynasty","winning_category":"History & Biography","cover":"https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1611952534l/43868109.jpg","url":"https://www.goodreads.com/choiceawards/best-history-biography-books-2021"},{"book_id":57282218,"name":"Lore Olympus: Volume One","winning_category":"Graphic Novels & Comics","cover":"https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1614887007l/57282218.jpg","url":"https://www.goodreads.com/choiceawards/best-graphic-novels-comics-2021"},{"book_id":56914101,"name":"The Hill We Climb: An Inaugural Poem for the Country","winning_category":"Poetry","cover":"https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1612178266l/56914101.jpg","url":"https://www.goodreads.com/choiceawards/best-poetry-books-2021"},{"book_id":57190892,"name":"The Spanish Love Deception","winning_category":"Debut Novel","cover":"https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1614122544l/57190892._SY475_.jpg","url":"https://www.goodreads.com/choiceawards/best-debut-novel-2021"},{"book_id":57812106,"name":"Firekeeper's Daughter","winning_category":"Young Adult Fiction","cover":"https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1619021348l/57812106._SY475_.jpg","url":"https://www.goodreads.com/choiceawards/best-young-adult-fiction-books-2021"},{"book_id":54589790,"name":"Rule of Wolves","winning_category":"Young Adult Fantasy","cover":"https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1598133973l/54589790.jpg","url":"https://www.goodreads.com/choiceawards/best-young-adult-fantasy-books-2021"},{"book_id":57094644,"name":"Daughter of the Deep","winning_category":"Middle Grade & Children's","cover":"https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1622742517l/57094644.jpg","url":"https://www.goodreads.com/choiceawards/best-childrens-books-2021"}]

listadoPopulares = [{"book_id":"56597885","position":"1","name":"The Lost Apothecary","cover":"https://images-na.ssl-images-amazon.com/images/S/compressed.photo.goodreads.com/books/1593013000i/53288434.jpg","rating":3.76,"url":"https://www.goodreads.com/book/show/53288434-the-lost-apothecary"},{"book_id":"54120408","position":"2","name":"Klara and the Sun","cover":"https://images-na.ssl-images-amazon.com/images/S/compressed.photo.goodreads.com/books/1603206535i/54120408.jpg","rating":3.78,"url":"https://www.goodreads.com/book/show/54120408-klara-and-the-sun"},{"book_id":"53914938","position":"3","name":"The Rose Code","cover":"https://images-na.ssl-images-amazon.com/images/S/compressed.photo.goodreads.com/books/1596553679i/53914938.jpg","rating":4.47,"url":"https://www.goodreads.com/book/show/53914938-the-rose-code"},{"book_id":"36307674","position":"4","name":"Rule of Wolves (King of Scars, #2)","cover":"https://images-na.ssl-images-amazon.com/images/S/compressed.photo.goodreads.com/books/1598133584i/36307674.jpg","rating":4.4,"url":"https://www.goodreads.com/book/show/36307674-rule-of-wolves"},{"book_id":"52346471","position":"5","name":"Firekeeper's Daughter","cover":"https://images-na.ssl-images-amazon.com/images/S/compressed.photo.goodreads.com/books/1595093218i/52346471.jpg","rating":4.38,"url":"https://www.goodreads.com/book/show/52346471-firekeeper-s-daughter"},{"book_id":"17699855","position":"6","name":"Chain of Iron (The Last Hours, #2)","cover":"https://images-na.ssl-images-amazon.com/images/S/compressed.photo.goodreads.com/books/1604591461i/17699855.jpg","rating":4.47,"url":"https://www.goodreads.com/book/show/17699855-chain-of-iron"},{"book_id":"54798175","position":"7","name":"Later","cover":"https://images-na.ssl-images-amazon.com/images/S/compressed.photo.goodreads.com/books/1596448456i/54798175.jpg","rating":4.02,"url":"https://www.goodreads.com/book/show/54798175-later"},{"book_id":"53138197","position":"8","name":"Of Women and Salt","cover":"https://images-na.ssl-images-amazon.com/images/S/compressed.photo.goodreads.com/books/1595815950i/53138197.jpg","rating":0,"url":"https://www.goodreads.com/book/show/53138197-of-women-and-salt"},{"book_id":"51824384","position":"9","name":"Act Your Age, Eve Brown (The Brown Sisters, #3)","cover":"https://images-na.ssl-images-amazon.com/images/S/compressed.photo.goodreads.com/books/1598833651i/51824384.jpg","rating":4.18,"url":"https://www.goodreads.com/book/show/51824384-act-your-age-eve-brown"},{"book_id":"50279680","position":"10","name":"We Begin at the End","cover":"https://images-na.ssl-images-amazon.com/images/S/compressed.photo.goodreads.com/books/1603742175i/50279680.jpg","rating":4.18,"url":"https://www.goodreads.com/book/show/50279680-we-begin-at-the-end"},{"book_id":"54326395","position":"11","name":"The Dating Plan (Marriage Game, #2)","cover":"https://images-na.ssl-images-amazon.com/images/S/compressed.photo.goodreads.com/books/1595387142i/54326395.jpg","rating":3.67,"url":"https://www.goodreads.com/book/show/54326395-the-dating-plan"},{"book_id":"54621094","position":"12","name":"The Last House on Needless Street","cover":"https://images-na.ssl-images-amazon.com/images/S/compressed.photo.goodreads.com/books/1603323638i/54621094.jpg","rating":3.89,"url":"https://www.goodreads.com/book/show/54621094-the-last-house-on-needless-street"},{"book_id":"57812106","position":"13","name":"Firekeeper's Daughter","cover":"https://images-na.ssl-images-amazon.com/images/S/compressed.photo.goodreads.com/books/1619021348i/57812106.jpg","rating":4.38,"url":"https://www.goodreads.com/book/show/57812106-firekeeper-s-daughter"},{"book_id":"53138046","position":"14","name":"Every Last Fear","cover":"https://images-na.ssl-images-amazon.com/images/S/compressed.photo.goodreads.com/books/1615820265i/53138046.jpg","rating":3.94,"url":"https://www.goodreads.com/book/show/53138046-every-last-fear"},{"book_id":"54968118","position":"15","name":"The Code Breaker: Jennifer Doudna, Gene Editing, and the Future of the Human Race","cover":"https://images-na.ssl-images-amazon.com/images/S/compressed.photo.goodreads.com/books/1610894755i/54968118.jpg","rating":4.32,"url":"https://www.goodreads.com/book/show/54968118-the-code-breaker"}]

listadoResultante = []

for libro in listadoTop:
    for libroP in listadoPopulares:
        if libro['book_id'] == libroP['book_id']:
            libroP['anio'] = 2015
            libroP['mes'] = 5
            libroP['api'] = 'HapiBooks'
            libroP['endPoints'] = ['Get the Top 15 most popular books in a Month of an Year','Get the Awarded Books of a Year']
            libroP['fechaConsulta'] = datetime.now()
            listadoResultante.append(libroP)
